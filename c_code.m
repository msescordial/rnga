n = 10;
b = [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000]; 

t = [189776.0555, 155375.4928, 57159.4495, 94240.0002, 34668.9586, 46798.1991, 25683.3962, 21027.7863, 34668.9586, 12753.9971;
    155375.4928, 189776.0555, 127210.6943, 94240.0002, 57159.4495, 77157.1863, 34668.9586,  31369.7710,  46798.1991,  17216.0953;
    57159.4495,  127210.6943, 189776.0555, 57159.4495, 127210.6943, 127210.6943, 94240.0002,  34668.9586,  42344.7617,  21027.7863;
    94240.0002,  94240.0002,  57159.4495,  189776.0555, 127210.6943, 94240.0002, 57159.4495,  46798.1991,  127210.6943, 57159.4495;
    31369.7710,  57159.4495,  155375.4928, 127210.6943, 189776.0555, 155375.4928, 94240.0002,  77157.1863,  94240.0002,  46798.1991;
    46798.1991,  77157.1863,  127210.6943, 94240.0002, 155375.4928, 189776.0555, 171716.4761,  127210.6943, 155375.4928, 57159.4495;
    25683.3962,  34668.9586,  94240.0002,  57159.4495,  94240.0002,  171716.4761, 189776.0555, 155375.4928,  140589.5598, 77157.1863;
    21027.7863,  31369.7710,  34668.9586,  46798.1991, 77157.1863,  127210.6943, 155375.4928, 189776.0555,  171716.4761, 94240.0002;
    34668.9586,  46798.1991,  42344.7617,  127210.6943, 94240.0002, 155375.4928, 140589.5598, 171716.4761,  189776.0555, 69814.7092;
    94240.0002,  17216.0953,  21027.7863,  57159.4495,  46798.1991,  57159.4495,  77157.1863, 94240.0002,  69814.7092,  189776.0555];

o = [296505.25, 1283071.57, 1019880.17, 1109602.95, 1201412.68, 688445.92, 1222715.53, 1386604.88, 740705.07, 395175.82];

d = [434217.04, 1423333.76, 1076025.19, 1216932.14, 1403724.70, 759231.74, 769671.16, 821143.18, 1082208.75, 357632.20];

a = zeros(n);
oc = zeros(n);
dc = zeros(n);
diff = zeros(n);
dif = zeros(n);
di = zeros(n);

again = 1;
     
while (again == 1)
    
    for i = 1:n
        oc(i) = 0; 
        for j = 1:n      
            oc(i) = oc(i) + t(i,j)*b(j);
        end 
        a(i) = o(i)/oc(i);     
        %fprintf('%.2f\t',oc(i));      
        %fprintf('%.4f\t',a(i));     
        %fprintf('\n'); 
    end

    for j = 1:n  
        for i = 1:n       
            t(i,j) = t(i,j)*a(i);
        end
    end

    %fprintf('\n');  

    %for i = 1:n 
        %for j = 1:n       
            %fprintf('%.2f\t',t(i,j));         
            %fprintf('\t');
        %end    
        %fprintf('\n');
    %end

    %fprintf('\n');  

    for j = 1:n   
        dc(j) = 0;     
        for i = 1:n      
            dc(j) = dc(j) + t(i,j);
        end  
        b(j) = d(j)/dc(j);      
        %fprintf('%.2f\t', dc(j));      
        %fprintf('%.4f\t', b(j));     
        %fprintf('\n'); 
    end

    for i=1:n    
        for j=1:n     
            t(i,j) = t(i,j) * b(j);          
        end
    end

    %fprintf('\n'); 
    for i = 1:n
        oc(i) = 0;     
        for j = 1:n     
            oc(i) = oc(i) + t(i,j);
        end
        diff(i) = o(i) - oc(i); 
        dif(i) = diff(i); 
        di(i) = abs(dif(i));   
        %fprintf('%.2f\t', oc(i));   
        %fprintf('%.4f\t', diff(i));   
        %fprintf('%d', dif(i));   
        %fprintf('%d', di(i));  
        %fprintf('\n');
    end

    if (di(1)>1 || di(2)>1 || di(3)>1 || di(4)>1 || di(5)>1 || di(6)>1|| di(7)>1|| di(8)>1|| di(9)>1|| di(10)>1) 
        again = 1;
    else 
        again = 0;       
    end

    fprintf('\n');  

    for i = 1:n    
        for j = 1:n       
            fprintf('%.2f\t',t(i,j));       
            fprintf('\t');
        end     
    fprintf('\n');
    end 

end
    
    
